# API Comparison: V3.2 vs V3.3

This document outlines the changes made to the API endpoints between version 3.2 and 3.3.

## `/health` Endpoint

### V3.2 (Before)

The `/health` endpoint provided a simple status check.

**Request:**
```
GET /health
```

**Response (200 OK):**
```json
{
  "status": "healthy"
}
```

### V3.3 (After)

The `/health` endpoint now includes the system uptime in seconds.

**Request:**
```
GET /health
```

**Response (200 OK):**
```json
{
  "status": "healthy",
  "uptime_seconds": 3600.5
}
```

---

## `/cameras` Endpoint

### V3.2 (Before)

The `/cameras` endpoint provided basic information about the configured cameras.

**Request:**
```
GET /cameras
```

**Response (200 OK):**
```json
{
  "camera_1": {
    "name": "Camera 1",
    "counting_line_enabled": true,
    "classes_to_count": ["person"]
  },
  "camera_2": {
    "name": "Camera 2",
    "counting_line_enabled": true,
    "classes_to_count": ["person", "car"]
  }
}
```

### V3.3 (After)

The `/cameras` endpoint now includes the RTSP URL, counting line coordinates, and the real-time connectivity status of each camera.

**Request:**
```
GET /cameras
```

**Response (200 OK):**
```json
{
  "camera_1": {
    "name": "Camera 1",
    "rtsp_url": "rtsp://localhost:18554/mystream",
    "counting_line_enabled": true,
    "counting_line_coordinates": [[240, 0], [240, 480]],
    "classes_to_count": ["person"],
    "status": {
      "connected": true,
      "thread_alive": true
    }
  },
  "camera_2": {
    "name": "Camera 2",
    "rtsp_url": "rtsp://localhost:18554/mystream",
    "counting_line_enabled": true,
    "counting_line_coordinates": [[240, 0], [240, 480]],
    "classes_to_count": ["person", "car"],
    "status": {
      "connected": false,
      "thread_alive": false
    }
  }
}
```

---

## `/status` Endpoint

### V3.2 (Before)

The `/status` endpoint provided a general overview of the system status.

**Request:**
```
GET /status
```

**Response (200 OK):**
```json
{
  "system": "running",
  "queue_size": 10,
  "camera_status": {
    "camera_1": {
      "connected": true,
      "thread_alive": true
    }
  },
  "counting_status": {
    "timestamp": "2025-11-14T10:30:00.123456",
    "cameras": {
      "camera_1": {
        "name": "Camera 1",
        "in_count": 15,
        "out_count": 8,
        "total_count": 23,
        "unique_tracks": 25,
        "time_since_last_log": 120.5,
        "next_log_in": 779.5
      }
    }
  }
}
```

### V3.3 (After)

The `/status` endpoint now provides a more detailed and structured overview. It includes system uptime, and detailed camera information is now under a unified `cameras` object. The `counting_status` now provides per-class IN/OUT counts.

**Request:**
```
GET /status
```

**Response (200 OK):**
```json
{
  "system": "running",
  "uptime_seconds": 3600.5,
  "queue_size": 10,
  "cameras": {
    "camera_1": {
      "name": "Camera 1",
      "rtsp_url": "rtsp://localhost:18554/mystream",
      "counting_line_enabled": true,
      "counting_line_coordinates": [[240, 0], [240, 480]],
      "classes_to_count": ["person"],
      "status": {
        "connected": true,
        "thread_alive": true
      }
    }
  },
  "counting_status": {
    "timestamp": "2025-11-14T10:30:00.123456",
    "cameras": {
      "camera_1": {
        "name": "Camera 1",
        "unique_tracks": 25,
        "time_since_last_log": 120.5,
        "next_log_in": 779.5,
        "classwise_counts": {
          "person": {
            "IN": 15,
            "OUT": 8
          }
        }
      }
    }
  }
}
```
